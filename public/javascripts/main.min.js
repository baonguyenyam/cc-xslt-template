"use strict";var editor,ModuleChoose="",App={note:"\nCác bước tạo file XSLT\n=====================\n\n1) Chọn Modules\n2) Thêm/bớt các attribute hoặc elements\n\nPhím tắt\n=====================\nCommand + Left: Di chuyển tới đầu dòng code\nCommand + Ctrl + Up: Di chuyển dòng code lên trên\nCommand + D: Chọn cùng giá trị",xslt_top:'<?xml version="1.0" encoding="utf-8"?>\n<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">\n<xsl:output method="html" indent="yes"/>\n\n',xslt_bottom:"</xsl:stylesheet>",xslt_module_top:'\x3c!--Begin XXX--\x3e\n<xsl:template match="/">\n',xslt_module_top_section:'<section class="canhcam-YYY-1">\n',xslt_module_top_article:'<article class="list-items">\n',xslt_module_middle:'\x3c!--Call XXX Child--\x3e\n<xsl:apply-templates select="/XXXList/XXX"></xsl:apply-templates>',xslt_module_bottom:"</xsl:template>\n\n",xslt_module_bottom_section:"</section>\n",xslt_module_bottom_article:"</article>\n",xslt_module_top_child:'\x3c!--Begin XXX Child--\x3e\n<xsl:template match="XXX">\n',xslt_module_child_middle:'\x3c!--item--\x3e\n<div class="item">\n<xsl:attribute name="bg-img">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n\x3c!--image--\x3e\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="alt">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n\x3c!--link--\x3e\n<xsl:if test="Url != \'\'">\n<a>\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:value-of select="/XXXList/ViewMore"></xsl:value-of>\n</a>\n</xsl:if>\n</div>\n',xslt_module_child_news_advanced_middle:'\x3c!-- item 1 --\x3e\n<xsl:if test="position() = 1 ">\n<xsl:text disable-output-escaping="yes">&lt;div class="col-lg-6 hot-item"&gt;</xsl:text>\n<xsl:apply-templates select="XXXItem" mode="XXXItem"></xsl:apply-templates>\n</xsl:if>\n\x3c!-- item 2,3 --\x3e\n<xsl:if test="position() = 2 ">\n<xsl:text disable-output-escaping="yes">&lt;/div&gt;</xsl:text>\n<xsl:text disable-output-escaping="yes">&lt;div class="col-lg-6 child-hot-item"&gt;</xsl:text>\n<xsl:apply-templates select="XXXItem" mode="XXXItem"></xsl:apply-templates>\n</xsl:if>\n\x3c!-- item 3 --\x3e\n<xsl:if test="position() = 3 ">\n<xsl:apply-templates select="XXXItem" mode="XXXItem"></xsl:apply-templates>\n<xsl:text disable-output-escaping="yes">&lt;/div&gt;</xsl:text>\n<xsl:text disable-output-escaping="yes">&lt;div class="other-news"&gt;</xsl:text>\n</xsl:if>\n\x3c!-- item 4,5,6,7... --\x3e\n<xsl:if test="position() > 3 ">\n<div class="col-sm-6 col-lg-3">\n<xsl:apply-templates select="XXXItem" mode="XXXItem"></xsl:apply-templates>\n</div>\n</xsl:if>\n\x3c!-- item last --\x3e\n<xsl:if test="position() = last() ">\n<xsl:text disable-output-escaping="yes">&lt;/div&gt;</xsl:text>\n</xsl:if>\n</xsl:template>\n\n\x3c!--Begin XXX Items--\x3e\n<xsl:template match="XXXItem" mode="XXXItem">\n\x3c!--item--\x3e\n<div class="item">\n\x3c!--target--\x3e\n<xsl:attribute name="id">\n<xsl:text>YYY-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>\n</xsl:attribute>\n<figure>\n<xsl:attribute name="bg-img">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n\x3c!--image--\x3e\n<a class="thumb">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="alt">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n</a>\n\x3c!--title--\x3e\n<figcaption>\n<a class="titlelink">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<h2><xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of></h2>\n<p class="sub"><xsl:value-of select="SubTitle" disable-output-escaping="yes"></xsl:value-of></p>\n</a>\n<time><em class="fa fa-calendar"></em><xsl:value-of select="CreatedDate"></xsl:value-of></time>\n<p>\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n<a class="readmore">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<xsl:value-of select="/XXXList/ViewMore" disable-output-escaping="yes"></xsl:value-of>\n</a>\n</figcaption>\n</figure>\n</div>\n<xsl:value-of select="EditLink" disable-output-escaping="yes"></xsl:value-of>\n',xslt_module_child_news_middle:'\x3c!--item--\x3e\n<div class="item">\n\x3c!--album target--\x3e\n<xsl:attribute name="id">\n<xsl:text>news-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>\n</xsl:attribute>\n<figure>\n<xsl:attribute name="bg-img">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n\x3c!--image--\x3e\n<a class="thumb">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="alt">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n</a>\n\x3c!--title--\x3e\n<figcaption>\n<a class="titlelink">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<h2><xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of></h2>\n<p class="sub"><xsl:value-of select="SubTitle" disable-output-escaping="yes"></xsl:value-of></p>\n</a>\n<time><xsl:value-of select="CreatedDate"></xsl:value-of></time>\n<p>\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n<a class="readmore">\n<xsl:attribute name="href">\n<xsl:value-of select="Url"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="target">\n<xsl:value-of select="Target"></xsl:value-of>\n</xsl:attribute>\n<xsl:value-of select="/XXXList/ViewMore" disable-output-escaping="yes"></xsl:value-of>\n</a>\n</figcaption>\n</figure>\n</div>\n<xsl:value-of select="EditLink" disable-output-escaping="yes"></xsl:value-of>\n',xslt_module_child_gallery_middle:'\x3c!--item--\x3e\n<div class="item">\n\x3c!--album target--\x3e\n<xsl:attribute name="data-target">\n<xsl:text>#YYY-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>\n</xsl:attribute>\n<a class="thumb">\n<xsl:attribute name="href">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<figure>\n<xsl:attribute name="bg-img">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n\x3c!--image--\x3e\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="alt">\n<xsl:value-of select="Image/Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n\x3c!--title--\x3e\n<figcaption>\n<h2><xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of></h2>\n</figcaption>\n</figure>\n</a>\n\x3c!--album list--\x3e\n<div class="d-none imagesinalbum">\n\x3c!--album id--\x3e\n<xsl:attribute name="id">\n<xsl:text>YYY-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>\n</xsl:attribute>\n<xsl:apply-templates select="Images" mode="ImageByAlbum"></xsl:apply-templates>\n</div>\n</div>\n<xsl:value-of select="EditLink" disable-output-escaping="yes"></xsl:value-of>\n',xslt_module_child_video_middle:'\x3c!--item--\x3e\n<div class="item">\n\x3c!--album target--\x3e\n<xsl:attribute name="id">\n<xsl:text>YYY-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>\n</xsl:attribute>\n<a class="thumb">\n<xsl:attribute name="href">\n<xsl:value-of select="VideoUrl"></xsl:value-of>\n</xsl:attribute>\n<figure>\n<xsl:attribute name="bg-img">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n\x3c!--image--\x3e\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="alt">\n<xsl:value-of select="Image/Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n\x3c!--title--\x3e\n<figcaption>\n<h2><xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of></h2>\n</figcaption>\n</figure>\n</a>\n</div>\n<xsl:value-of select="EditLink" disable-output-escaping="yes"></xsl:value-of>\n',xslt_module_bottom_child:"</xsl:template>\n\n",xslt_attr_top:'\x3c!--Attribute XXX--\x3e\n<xsl:attribute name="XXX">\n',xslt_attr_bottom:"\n</xsl:attribute>",xslt_alt:'<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>',xslt_title:'<xsl:value-of select="Title"></xsl:value-of>',xslt_target:'<xsl:value-of select="Target"></xsl:value-of>',xslt_url:'<xsl:value-of select="Url"></xsl:value-of>',xslt_src:'<xsl:value-of select="ImageUrl"></xsl:value-of>',xslt_id:'<xsl:text>item-</xsl:text>\n<xsl:value-of select="position()"></xsl:value-of>',xslt_class:"<xsl:text>classname</xsl:text>",xslt_class_active:"<xsl:text>classname active</xsl:text>"},substringMatcher=function(l){return function(e,t){new RegExp(e,"i");t(l)}},elements=["img","a","div","p","section","article","ul","li","hr"],attributes=["alt","src","title","class","class-active","href","target","id"],addnew=[];function __buildModule(e){var t="",l="",s="",n="";s='<xsl:if test="count(/'+e+"List/"+e+') > 0">\n'+App.xslt_module_top_section+t+App.xslt_module_top_article,n="\n"+App.xslt_module_bottom_article+App.xslt_module_bottom_section+"</xsl:if>\n","gallery"===e.toLowerCase()?(t='\x3c!--Title--\x3e\n<caption>\n<h1 class="title">\n<xsl:value-of select="/XXXList/ModuleTitle"></xsl:value-of>\n</h1>\n<p class="lead">\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n</caption>\n',l='\x3c!--Begin Gallery Album--\x3e\n<xsl:template match="Images" mode="ImageByAlbum">\n<xsl:if test="position() > 1">\n<a>\n<xsl:attribute name="href">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n<img>\n<xsl:attribute name="src">\n<xsl:value-of select="ImageUrl"></xsl:value-of>\n</xsl:attribute>\n<xsl:attribute name="title">\n<xsl:value-of select="Title" disable-output-escaping="yes"></xsl:value-of>\n</xsl:attribute>\n</img>\n</a>\n</xsl:if>\n</xsl:template>\n\n',App.xslt_module_child_middle=App.xslt_module_child_gallery_middle,s=App.xslt_module_top_section+t+'<xsl:if test="count(/'+e+"List/"+e+') > 0">\n'+App.xslt_module_top_article,n="\n"+App.xslt_module_bottom_article+"</xsl:if>\n"+App.xslt_module_bottom_section):"video"===e.toLowerCase()?(t='\x3c!--Title--\x3e\n<caption>\n<h1 class="title">\n<xsl:value-of select="/XXXList/ModuleTitle"></xsl:value-of>\n</h1>\n<p class="lead">\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n</caption>\n',App.xslt_module_child_middle=App.xslt_module_child_video_middle,s=App.xslt_module_top_section+t+'<xsl:if test="count(/'+e+"List/"+e+') > 0">\n'+App.xslt_module_top_article,n="\n"+App.xslt_module_bottom_article+"</xsl:if>\n"+App.xslt_module_bottom_section):"news"===e.toLowerCase()?(t='\x3c!--Title--\x3e\n<caption>\n<h1 class="title">\n<xsl:value-of select="/XXXList/ZoneTitle"></xsl:value-of>\n</h1>\n<p class="lead">\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n</caption>\n',App.xslt_module_child_middle=App.xslt_module_child_news_middle,s=App.xslt_module_top_section+t+'<xsl:if test="count(/'+e+"List/"+e+') > 0">\n'+App.xslt_module_top_article,n="\n"+App.xslt_module_bottom_article+"</xsl:if>\n"+App.xslt_module_bottom_section):"news-advanced"===e.toLowerCase()&&(t='\x3c!--Title--\x3e\n<caption>\n<h1 class="title">\n<xsl:value-of select="/XXXList/ZoneTitle"></xsl:value-of>\n</h1>\n<p class="lead">\n<xsl:value-of select="BriefContent" disable-output-escaping="yes"></xsl:value-of>\n</p>\n</caption>\n',App.xslt_module_child_middle=App.xslt_module_child_news_advanced_middle,s=App.xslt_module_top_section+t+'<xsl:if test="count(/'+e+"List/"+e+') > 0">\n'+App.xslt_module_top_article,n="\n"+App.xslt_module_bottom_article+"</xsl:if>\n"+App.xslt_module_bottom_section);var a=App.xslt_top+App.xslt_module_top+s+App.xslt_module_middle+n+App.xslt_module_bottom+App.xslt_module_top_child+App.xslt_module_child_middle+App.xslt_module_bottom_child+l+App.xslt_bottom,i=new RegExp("News-Advanced","g"),o=new RegExp("XXX","g"),x=new RegExp("YYY","g");editor.setValue(a.replace(o,e).replace(x,e.toLowerCase()).replace(i,"News")),editor.refresh(),inDents()}function __insertTemplateNewValue(e,t,l){var s=new RegExp("XXX","g"),n=new RegExp("News-Advanced","g");insertText((""===l?"\x3c!--Value of "+t+"--\x3e\n"+e:"\x3c!--"+l.replace(s,ModuleChoose.replace(n,"News"))+"--\x3e\n"+e).replace(s,ModuleChoose.replace(n,"News"))+"\n")}function __insertTemplateElms(e){var t=new RegExp("XXX","g");insertText(("\x3c!--Elements XXX--\x3e\n<"+e+"></"+e+">").replace(t,e))}function __insertTemplateAttr(e){var t="",l=new RegExp("XXX","g");"alt"===e?t=App.xslt_attr_top+App.xslt_alt+App.xslt_attr_bottom:"src"===e?t=App.xslt_attr_top+App.xslt_src+App.xslt_attr_bottom:"target"===e?t=App.xslt_attr_top+App.xslt_target+App.xslt_attr_bottom:"href"===e?t=App.xslt_attr_top+App.xslt_url+App.xslt_attr_bottom:"title"===e?t=App.xslt_attr_top+App.xslt_title+App.xslt_attr_bottom:"class"===e?t=App.xslt_attr_top+App.xslt_class+App.xslt_attr_bottom:"id"===e?t=App.xslt_attr_top+App.xslt_id+App.xslt_attr_bottom:"class-active"===e&&(t="<xsl:if test=\"IsActive='true'\">\n"+App.xslt_attr_top+App.xslt_class_active+App.xslt_attr_bottom+"\n</xsl:if>",e="class"),insertText(t.replace(l,e)+"\n")}function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"<br>")}function insertText(e){var t=$(".CodeMirror")[0].CodeMirror.getDoc(),l=t.getCursor(),s=t.getLine(l.line),n={line:l.line,ch:l.ch};s.length,t.replaceRange(e,n),inDents()}function completeAfter(e,t){e.getCursor();return t&&!t()||setTimeout(function(){e.state.completionActive||e.showHint({completeSingle:!1})},100),CodeMirror.Pass}function completeIfAfterLt(t){return completeAfter(t,function(){var e=t.getCursor();return"<"==t.getRange(CodeMirror.Pos(e.line,e.ch-1),e)})}function completeIfInTag(t){return completeAfter(t,function(){var e=t.getTokenAt(t.getCursor());return!!("string"!=e.type||/['"]/.test(e.string.charAt(e.string.length-1))&&1!=e.string.length)&&CodeMirror.innerMode(t.getMode(),e.state).state.tagName})}function ___ReadyAdd(){$(".d-none").removeClass("d-none"),$(window).bind("beforeunload",function(){return"Bạn có muốn thoát trang ngay bây giờ?"}),$(".body-control").addClass("active")}function changeX(n){$(".dropdown-item").each(function(){var e=$(this).attr("old-data-set"),t=$(this).attr("data-set"),l=new RegExp("XXX","g"),s=new RegExp(e,"g");""===e?($(this).attr("old-data-set",n),$(this).attr("data-set",t.replace(l,n))):($(this).attr("old-data-set",n),$(this).attr("data-set",t.replace(s,n)))})}function inDents(){var t=$(".CodeMirror")[0].CodeMirror.getDoc();editor.operation(function(){for(var e=0;e<t.size;++e)editor.indentLine(e,"smart")})}$(document).ready(function(){$("#code").html(App.note),editor=CodeMirror.fromTextArea(document.getElementById("code"),{mode:"text/x-markdown",lineNumbers:!0,keyMap:"sublime",autoCloseBrackets:!0,matchBrackets:!0,showCursorWhenSelecting:!0,theme:"monokai",lineWrapping:!0,tabSize:4,indentUnit:4,smartIndent:!0,indentWithTabs:!0,styleActiveLine:!0,foldGutter:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Enter:"newLineAndIndent","'<'":completeAfter,"'/'":completeIfAfterLt,"' '":completeIfInTag,"'='":completeIfInTag,"Ctrl-Space":"autocomplete","Ctrl-Q":function(e){e.foldCode(e.getCursor())}},lint:!0}),$("#modules").on("change",function(e){var t=new RegExp("News-Advanced","g");ModuleChoose=e.target.value,editor.setOption("mode","xml"),changeX(ModuleChoose.replace(t,"News")),__buildModule(ModuleChoose),___ReadyAdd()}),$(".typeahead").typeahead({hint:!0,highlight:!0,minLength:0},{name:"addnew",source:substringMatcher(addnew)});var e=[];for(var t in attributes)if(attributes.hasOwnProperty(t)){var l='<option value="'+(n=attributes[t])+'"">'+n+"</option>";e.push(l)}$("#attrs").append(e),$("#attrs").select2({placeholder:"Vui lòng chọn",allowClear:!0}).on("select2:select",function(e){__insertTemplateAttr(e.target.value)});var s=[];for(var t in elements)if(elements.hasOwnProperty(t)){var n;l='<option value="'+(n=elements[t])+'"">'+n+"</option>";s.push(l)}$("#elms").append(s),$("#elms").select2({placeholder:"Vui lòng chọn",allowClear:!0}).on("select2:select",function(e){__insertTemplateElms(e.target.value)}),$(".dropdown").click(function(){var e=$(this).parents(".cnt"),t=escapeHtml($(e).find(".dropdown-item").attr("data-set"));$(e).find(".dropdown-item").html(t),$(e).find(".dropdown-menu").toggleClass("active")}),$(".dropdown-item").click(function(){$(this).parents(".dropdown-menu").toggleClass("active")})}),$(".dropdown-item").on("click",function(e){var t=$(this).attr("data-set"),l=$(this).attr("data-comment");__insertTemplateNewValue(t,$(this).parents(".cnt").find(".val").text(),l)}),$("#indent").on("click",function(e){e.preventDefault(),inDents()});